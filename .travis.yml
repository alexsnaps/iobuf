env:
  global:
    - secure: bTFyenYvLoiAUnDMABIIMv4djoXZfFsANl4NyWQmvHxTLwu9wtbkxbBfRScMU/5khE3yGBoEB9CR8Pghc9h99RNyKaR8NzFxpe95o4TcpPv4eIHECbtlk2DdmFcBPTDlFAJ46nqUj+QUUFztbe0ZjLA/8BL9APHWGBX56zNHgIk=

language: rust
sudo: false
version:
  - nightly
os:
  - linux
script:
  - cargo build --verbose
  - cargo build --release --verbose
  - cargo test --verbose
  - cargo bench --verbose
  - cargo doc --verbose
after_script:
  - cp -R target/doc doc
  - |
        [ $TRAVIS_BRANCH = master ] &&
        [ $TRAVIS_PULL_REQUEST = false ] &&
        echo '<meta http-equiv=refresh content=0;url=iobuf/index.html>' > target/doc/index.html &&
        git clone https://github.com/davisp/ghp-import &&
        ./ghp-import/ghp-import -n target/doc &&
        git push -fq https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git gh-pages